// Code generated by protoc-gen-go-leo. DO NOT EDIT.

package user

import (
	context "context"
	cqrs "github.com/go-leo/leo/v3/cqrs"
	emptypb "google.golang.org/protobuf/types/known/emptypb"
)

func NewUserManagerCqrsService[
	CreateUserQueryType CreateUserQuery, CreateUserResultType CreateUserResult,
	DeleteUserCommandType DeleteUserCommand,
	UpdateUserCommandType UpdateUserCommand,
	GetUserQueryType GetUserQuery, GetUserResultType GetUserResult,
	GetUsersQueryType GetUsersQuery, GetUsersResultType GetUsersResult,
](
	createUserHandler cqrs.QueryHandler[CreateUserQueryType, CreateUserResultType],
	deleteUserHandler cqrs.CommandHandler[DeleteUserCommandType],
	updateUserHandler cqrs.CommandHandler[UpdateUserCommandType],
	getUserHandler cqrs.QueryHandler[GetUserQueryType, GetUserResultType],
	getUsersHandler cqrs.QueryHandler[GetUsersQueryType, GetUsersResultType],
) (UserManagerService, error) {
	var bus cqrs.SampleBus
	if err := bus.RegisterQuery(createUserHandler); err != nil {
		return nil, err
	}
	if err := bus.RegisterCommand(deleteUserHandler); err != nil {
		return nil, err
	}
	if err := bus.RegisterCommand(updateUserHandler); err != nil {
		return nil, err
	}
	if err := bus.RegisterQuery(getUserHandler); err != nil {
		return nil, err
	}
	if err := bus.RegisterQuery(getUsersHandler); err != nil {
		return nil, err
	}
	return &userManagerCqrsService{bus: &bus}, nil
}

type userManagerCqrsService struct {
	bus cqrs.Bus
}

func (svc *userManagerCqrsService) CreateUser(ctx context.Context, request *CreateUserRequest) (*CreateUserResponse, error) {
	var query CreateUserQuery
	q, ctx, err := query.From(ctx, request)
	if err != nil {
		return nil, err
	}
	r, err := svc.bus.Query(ctx, q)
	if err != nil {
		return nil, err
	}
	return r.(CreateUserResult).To(ctx)
}

func (svc *userManagerCqrsService) DeleteUser(ctx context.Context, request *DeleteUsersRequest) (*emptypb.Empty, error) {
	var command DeleteUserCommand
	command, ctx, err := command.From(ctx, request)
	if err != nil {
		return nil, err
	}

	if err := svc.bus.Exec(ctx, command); err != nil {
		return nil, err
	}
	return new(emptypb.Empty), nil
}

func (svc *userManagerCqrsService) UpdateUser(ctx context.Context, request *UpdateUserRequest) (*emptypb.Empty, error) {
	var command UpdateUserCommand
	command, ctx, err := command.From(ctx, request)
	if err != nil {
		return nil, err
	}

	if err := svc.bus.Exec(ctx, command); err != nil {
		return nil, err
	}
	return new(emptypb.Empty), nil
}

func (svc *userManagerCqrsService) GetUser(ctx context.Context, request *GetUserRequest) (*GetUserResponse, error) {
	var query GetUserQuery
	q, ctx, err := query.From(ctx, request)
	if err != nil {
		return nil, err
	}
	r, err := svc.bus.Query(ctx, q)
	if err != nil {
		return nil, err
	}
	return r.(GetUserResult).To(ctx)
}

func (svc *userManagerCqrsService) GetUsers(ctx context.Context, request *GetUsersRequest) (*GetUsersResponse, error) {
	var query GetUsersQuery
	q, ctx, err := query.From(ctx, request)
	if err != nil {
		return nil, err
	}
	r, err := svc.bus.Query(ctx, q)
	if err != nil {
		return nil, err
	}
	return r.(GetUsersResult).To(ctx)
}

type (
	DeleteUserCommand interface {
		isDeleteUserCommand_Kind()
		From(context.Context, *DeleteUsersRequest) (DeleteUserCommand, context.Context, error)
	}
	UnimplementedDeleteUserCommand struct{}

	UpdateUserCommand interface {
		isUpdateUserCommand_Kind()
		From(context.Context, *UpdateUserRequest) (UpdateUserCommand, context.Context, error)
	}
	UnimplementedUpdateUserCommand struct{}
)

type (
	CreateUserQuery interface {
		isCreateUserQuery_Kind()
		From(context.Context, *CreateUserRequest) (CreateUserQuery, context.Context, error)
	}
	CreateUserResult interface {
		isCreateUserResult_Kind()
		To(context.Context) (*CreateUserResponse, error)
	}
	UnimplementedCreateUserQuery  struct{}
	UnimplementedCreateUserResult struct{}

	GetUserQuery interface {
		isGetUserQuery_Kind()
		From(context.Context, *GetUserRequest) (GetUserQuery, context.Context, error)
	}
	GetUserResult interface {
		isGetUserResult_Kind()
		To(context.Context) (*GetUserResponse, error)
	}
	UnimplementedGetUserQuery  struct{}
	UnimplementedGetUserResult struct{}

	GetUsersQuery interface {
		isGetUsersQuery_Kind()
		From(context.Context, *GetUsersRequest) (GetUsersQuery, context.Context, error)
	}
	GetUsersResult interface {
		isGetUsersResult_Kind()
		To(context.Context) (*GetUsersResponse, error)
	}
	UnimplementedGetUsersQuery  struct{}
	UnimplementedGetUsersResult struct{}
)

func (UnimplementedDeleteUserCommand) isDeleteUserCommand_Kind() {}
func (UnimplementedDeleteUserCommand) From(context.Context, *DeleteUsersRequest) (DeleteUserCommand, context.Context, error) {
	panic("implement me")
	return nil, nil, nil
}
func (UnimplementedUpdateUserCommand) isUpdateUserCommand_Kind() {}
func (UnimplementedUpdateUserCommand) From(context.Context, *UpdateUserRequest) (UpdateUserCommand, context.Context, error) {
	panic("implement me")
	return nil, nil, nil
}
func (UnimplementedCreateUserQuery) isCreateUserQuery_Kind() {}
func (UnimplementedCreateUserQuery) From(context.Context, *CreateUserRequest) (CreateUserQuery, context.Context, error) {
	panic("implement me")
	return nil, nil, nil
}
func (UnimplementedCreateUserResult) isCreateUserResult_Kind() {}
func (UnimplementedCreateUserResult) To(context.Context) (*CreateUserResponse, error) {
	panic("implement me")
	return nil, nil
}

func (UnimplementedGetUserQuery) isGetUserQuery_Kind() {}
func (UnimplementedGetUserQuery) From(context.Context, *GetUserRequest) (GetUserQuery, context.Context, error) {
	panic("implement me")
	return nil, nil, nil
}
func (UnimplementedGetUserResult) isGetUserResult_Kind() {}
func (UnimplementedGetUserResult) To(context.Context) (*GetUserResponse, error) {
	panic("implement me")
	return nil, nil
}

func (UnimplementedGetUsersQuery) isGetUsersQuery_Kind() {}
func (UnimplementedGetUsersQuery) From(context.Context, *GetUsersRequest) (GetUsersQuery, context.Context, error) {
	panic("implement me")
	return nil, nil, nil
}
func (UnimplementedGetUsersResult) isGetUsersResult_Kind() {}
func (UnimplementedGetUsersResult) To(context.Context) (*GetUsersResponse, error) {
	panic("implement me")
	return nil, nil
}

// user/v1/cq/create_user_leo.query.pb.go
// user/v1/cq/delete_user_leo.query.pb.go
// user/v1/cq/update_user_leo.query.pb.go
// user/v1/cq/get_user_leo.query.pb.go
// user/v1/cq/get_users_leo.query.pb.go
