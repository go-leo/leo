flowchart TD
    A[开始] --> B{初始化配置选项}
    B --> C[创建监听器]
    C --> D{遍历资源}
    D -->|资源遍历结束| E{处理错误}
    E -->|有错误| F[停止所有监听器]
    F --> G[关闭通知通道]
    G --> H[返回错误通道]
    E -->|无错误| I[创建停止通道]
    I --> J[启动协程处理通知事件]
    J --> K{处理通知事件}
    K -->|错误事件| L[处理错误事件]
    L --> M[关闭通知通道]
    M --> N[返回]
    K -->|数据事件| O{检查上下文}
    O -->|上下文未取消| P[加载配置]
    P --> Q[发送配置到通道]
    Q --> R[继续处理]
    O -->|上下文取消| S[停止监听]
    S --> N[返回]
    O -->|停止信号| T[停止监听]
    T --> N[返回]
    I --> U[返回配置通道和错误通道]
    U --> N[返回]
